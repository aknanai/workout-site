{{ define "main" }}
<article class="program">
    <header class="program__header">
        <div class="container">
            <div class="program__header-content">
                <span class="program__category">{{ .Params.category | default "Program" }}</span>
                <h1 class="program__title">{{ .Title }}</h1>
                {{ with .Params.subtitle }}
                <p class="program__subtitle">{{ . }}</p>
                {{ end }}
                <div class="program__meta">
                    {{ with .Params.difficulty }}
                    <span class="program__badge program__badge--{{ . | lower }}">{{ . }}</span>
                    {{ end }}
                    {{ with .Params.duration }}
                    <span class="program__duration">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        {{ . }}
                    </span>
                    {{ end }}
                    {{ with .Params.frequency }}
                    <span class="program__frequency">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
                        {{ . }}
                    </span>
                    {{ end }}
                </div>
            </div>
        </div>
    </header>

    {{ if .Params.image }}
    <div class="program__image">
        <img src="{{ .Params.image }}" alt="{{ .Title }}">
    </div>
    {{ end }}

    <div class="program__content">
        <div class="container container--narrow">
            {{ .Content }}
        </div>
    </div>

    <!-- Related Programs -->
    <section class="related">
        <div class="container">
            <h2 class="related__title">More Programs</h2>
            <div class="cards-grid cards-grid--3">
                {{ $currentPage := . }}
                {{ range first 3 (where (where .Site.RegularPages "Section" "programs") ".Permalink" "!=" .Permalink) }}
                <article class="card">
                    <div class="card__image">
                        {{ if .Params.image }}
                        <img src="{{ .Params.image }}" alt="{{ .Title }}" loading="lazy">
                        {{ else }}
                        <div class="card__placeholder">
                            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"></circle><path d="M12 6v6l4 2"></path></svg>
                        </div>
                        {{ end }}
                    </div>
                    <div class="card__content">
                        <h3 class="card__title">{{ .Title }}</h3>
                        <a href="{{ .Permalink }}" class="card__link">View Program</a>
                    </div>
                </article>
                {{ end }}
            </div>
        </div>
    </section>
</article>
{{ end }}
